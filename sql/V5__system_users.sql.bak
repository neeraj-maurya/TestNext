-- Flyway migration for central admin system_users table
CREATE TABLE IF NOT EXISTS system_users (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  username VARCHAR(255) NOT NULL UNIQUE,
  email VARCHAR(255) NOT NULL UNIQUE,
  hashed_password VARCHAR(255),
  display_name VARCHAR(255),
  role VARCHAR(50) NOT NULL DEFAULT 'SYSTEM_ADMIN',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Seed with admin user (H2 syntax - use MERGE instead of INSERT ON CONFLICT)
MERGE INTO system_users (username, email, hashed_password, display_name, role, created_at)
VALUES ('admin', 'admin@example.com', 'hashed_admin_pass', 'Administrator', 'SYSTEM_ADMIN', CURRENT_TIMESTAMP);
